Guide de Migration d'une Application IIS

Ce processus est centr√© sur l'utilisation de Microsoft Web Deploy (MSDeploy) pour exporter la configuration et le contenu de l'ancien serveur et les importer sur le nouveau.

√âtape 1 : Pr√©paration et Audit de l'Environnement

    Audit de l'Application Source (Ancien IIS) :

        Inventaire des d√©pendances : R√©cup√©rez la liste de tous les composants, modules, versions de .NET Framework (ou .NET Core), pools d'applications, certificats SSL, liaisons (bindings) de sites, r√®gles de r√©√©criture d'URL, et les types d'authentification utilis√©s (ex: Authentification Windows).

        Web Deploy : Installez Microsoft Web Deploy (version 3.6 est souvent recommand√©e) sur les deux serveurs (source et destination).

        V√©rification des d√©pendances : Utilisez la commande msdeploy pour identifier les d√©pendances du site (par exemple, pour le Site par D√©faut avec l'ID 1) :

msdeploy -verb:getDependencies -source:metakey=lm/w3svc/1

Pr√©paration de l'Environnement Cible (Nouvel IIS) :

        Installation d'IIS : Installez le r√¥le IIS sur le nouveau serveur et assurez-vous qu'il s'agit d'une version r√©cente (ex: IIS 10).

        Installation des d√©pendances : Installez tous les composants logiciels, modules et versions de .NET requis identifi√©s dans l'audit (ex: ASP.NET 4.8, WebDAV, module de r√©√©criture d'URL, etc.).

√âtape 2 : Cr√©ation du Package de Migration

    Empaquetage du Site Web : Sur le serveur source (ancien IIS), utilisez Web Deploy pour cr√©er un package compress√© (.zip) qui contient le contenu du site, la configuration IIS, les certificats, et les ACL de fichiers/dossiers.

        Ex√©cutez la commande suivante (adaptez le chemin et le nom du fichier) :

msdeploy -verb:sync -source:metakey=lm/w3svc/1 -dest:package=C:\temp\MonSiteMigre.zip -declareParamFile:C:\temp\params.xml -enableLink:ContentPath -enableLink:Certificate -includeAcls

L'option -declareParamFile permet de g√©n√©rer un fichier de param√®tres que vous pourrez modifier pour l'importation (ex: changer les cha√Ænes de connexion, les chemins physiques).

Transfert : Copiez le fichier MonSiteMigre.zip et le fichier de param√®tres (params.xml) vers le serveur de destination.

√âtape 3 : D√©ploiement et Synchronisation

    Validation (Optionnel) : Sur le serveur de destination (nouvel IIS), effectuez une ex√©cution de test pour voir ce qui sera modifi√© ou manquant sans appliquer r√©ellement les changements.

msdeploy -verb:sync -source:package=C:\temp\MonSiteMigre.zip -dest:metakey=lm/w3svc/1 -setParamFile:C:\temp\params.xml -whatif > C:\temp\ValidationLog.txt


Analysez le fichier ValidationLog.txt pour v√©rifier s'il y a des d√©pendances manquantes ou des erreurs de configuration.

D√©ploiement R√©el : Une fois la validation r√©ussie, ex√©cutez la commande sans l'option -whatif pour effectuer la migration.

 msdeploy -verb:sync -source:package=C:\temp\MonSiteMigre.zip -dest:metakey=lm/w3svc/1 -setParamFile:C:\temp\params.xml

√âtape 4 : Post-Migration et Tests

    V√©rification de la Configuration :

        Pools d'applications : V√©rifiez que les pools d'applications ont bien √©t√© cr√©√©s avec la bonne version de .NET et le bon mode de pipeline (Classic/Integrated).

        Fichiers de Configuration : Le fichier web.config contient la configuration au niveau de l'application. Si l'ancienne version d'IIS utilisait des param√®tres de m√©tabase qui ne sont plus pris en charge (ex: IIS 6.0), ils pourraient n√©cessiter une refactorisation pour utiliser le format web.config compatible avec IIS r√©cent.

        Certificats et Liaisons : Confirmez que le certificat SSL a √©t√© import√© et que la liaison HTTPS est correcte.

    Mise √† Jour des Connexions : Si l'application utilise une base de donn√©es ou d'autres ressources externes, mettez √† jour les cha√Ænes de connexion et assurez-vous que les comptes de service du pool d'applications disposent des droits d'acc√®s n√©cessaires.

    Tests Fonctionnels :

        Testez le site en utilisant sa nouvelle adresse IP ou son nouveau nom d'h√¥te avant de modifier le DNS.

        Effectuez des tests fonctionnels complets (navigation, connexions de base de donn√©es, formulaires, authentification).

    Mise √† jour DNS : Une fois les tests concluants, modifiez l'enregistrement DNS pour diriger le trafic vers le nouveau serveur IIS.

    üìù Remarque sur Mycloud : Si vous migrez vers une plateforme cloud sp√©cifique (comme un service de Cloud IaaS ou PaaS), vous pourriez devoir adapter certaines √©tapes. Par exemple, si vous migrez vers Azure App Service, il existe des outils de migration sp√©cifiques (comme Azure App Service Migration Assistant). Si "Mycloud" propose un outil propri√©taire similaire, il est pr√©f√©rable de l'utiliser.

Souhaiteriez-vous des d√©tails suppl√©mentaires sur l'utilisation de Web Deploy ou sur la migration vers un environnement cloud sp√©cifique comme Azure ou Google Cloud ?

